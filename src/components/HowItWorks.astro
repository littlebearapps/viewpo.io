---
import Section from './Section.astro';
import SectionHeader from './SectionHeader.astro';

const steps = [
  {
    number: '01',
    title: 'Connect Your Providers',
    description: 'OAuth for GitHub, Vercel, and Netlify. API token for Cloudflare. One-time setup.',
    icon: `<path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m9.86-9.86a4.5 4.5 0 00-6.364 0l-4.5 4.5a4.5 4.5 0 001.242 7.244" />`,
  },
  {
    number: '02',
    title: 'Push Code',
    description: 'Work as usual. Viewpo detects new deployments automatically.',
    icon: `<circle cx="12" cy="12" r="3" /><line x1="12" y1="3" x2="12" y2="9" /><line x1="12" y1="15" x2="12" y2="21" />`,
  },
  {
    number: '03',
    title: 'Preview Instantly',
    description: 'Push notification → tap → viewport viewer. Verified in 10 seconds.',
    icon: `<path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0" />`,
  },
];
---

<Section id="how-it-works">
  <SectionHeader
    title="How It Works"
    subtitle="Three steps from push to preview. No dashboards, no context switching."
  />

  <div class="grid grid-cols-1 md:grid-cols-3 gap-12 md:gap-8 max-w-4xl mx-auto relative">
    <!-- Horizontal connector line (desktop only) -->
    <div class="hidden md:block absolute top-10 left-[calc(16.67%+2rem)] right-[calc(16.67%+2rem)] border-t border-neutral-300 dark:border-neutral-700" aria-hidden="true"></div>

    {steps.map((step, i) => (
      <div class={`reveal reveal-delay-${i + 1} text-center relative`}>
        {/* Step number — monospaced */}
        <div class="font-mono text-xs font-semibold text-primary/70 dark:text-primary/60 tracking-widest uppercase mb-4">
          {step.number}
        </div>

        {/* Icon circle — sits on top of the connector line */}
        <div class="relative z-10 w-20 h-20 rounded-full bg-white/70 dark:bg-neutral-900/60 backdrop-blur-sm border border-neutral-200 dark:border-neutral-800 flex items-center justify-center mx-auto mb-6 shadow-sm">
          <svg class="w-8 h-8 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
            <Fragment set:html={step.icon} />
          </svg>
        </div>

        {/* Mobile vertical connector (not on last item) */}
        {i < steps.length - 1 && (
          <div class="md:hidden w-px h-8 bg-gradient-to-b from-neutral-300 dark:from-neutral-700 to-transparent mx-auto absolute -bottom-10 left-1/2 -translate-x-1/2" aria-hidden="true"></div>
        )}

        <h3 class="font-heading font-semibold text-xl mb-2 text-foreground dark:text-white">{step.title}</h3>
        <p class="text-foreground/55 dark:text-neutral-400 leading-relaxed text-sm max-w-[240px] mx-auto">{step.description}</p>
      </div>
    ))}
  </div>
</Section>
