---
import Section from './Section.astro';
import SectionHeader from './SectionHeader.astro';
import Card from './Card.astro';
import Badge from './Badge.astro';
import { PRICING_TIERS } from '@utils/constants';
---

<Section id="pricing">
  <SectionHeader
    title="Simple, Transparent Pricing"
    subtitle="Start free. Upgrade when you need more projects, providers, or team features."
  />

  <div class="grid grid-cols-1 md:grid-cols-3 gap-5 max-w-5xl mx-auto items-stretch">
    {PRICING_TIERS.map((tier, i) => (
      <Card
        variant={tier.highlighted ? 'highlighted' : 'default'}
        class={`reveal reveal-delay-${i + 1} p-6 md:p-8 flex flex-col`}
      >
        {/* Most Popular badge */}
        {tier.highlighted && (
          <div class="absolute -top-3 left-1/2 -translate-x-1/2 z-10">
            <Badge variant="highlight" class="font-bold uppercase tracking-wider text-[11px]">
              Most Popular
            </Badge>
          </div>
        )}

        <div class="mb-6">
          <h3 class="font-heading font-semibold text-lg mb-3 text-foreground dark:text-white">{tier.name}</h3>
          <div class="flex items-baseline gap-1.5 mb-2">
            <span class="font-mono font-bold text-4xl text-foreground dark:text-white">{tier.price}</span>
            <span class="text-foreground/40 dark:text-neutral-500 text-sm">{tier.period}</span>
          </div>
          <p class="text-foreground/50 dark:text-neutral-500 text-sm">{tier.description}</p>
        </div>

        <ul class="flex-1 space-y-3 mb-8">
          {tier.features.map((feature) => (
            <li class="flex items-start gap-2.5 text-sm">
              <svg class="w-4 h-4 text-primary flex-shrink-0 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" />
              </svg>
              <span class="text-foreground/65 dark:text-neutral-400">{feature}</span>
            </li>
          ))}
        </ul>

        {tier.name === 'Free' ? (
          <a
            href="/beta/"
            class:list={[
              'w-full justify-center inline-flex items-center gap-2 font-heading font-semibold rounded-xl transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 hover:scale-[1.02] active:scale-[0.98] px-6 py-3 text-sm',
              'bg-primary text-white hover:bg-primary-hover focus:ring-primary shadow-md hover:shadow-lg',
              `plausible-event-name=Pricing+${tier.name}`,
            ]}
          >
            {tier.cta}
          </a>
        ) : (
          <button
            type="button"
            data-open-signup="notify"
            class:list={[
              'w-full justify-center inline-flex items-center gap-2 font-heading font-semibold rounded-xl transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 hover:scale-[1.02] active:scale-[0.98] px-6 py-3 text-sm',
              tier.highlighted
                ? 'bg-primary text-white hover:bg-primary-hover focus:ring-primary shadow-md hover:shadow-lg'
                : 'border border-neutral-300 dark:border-neutral-700 text-foreground dark:text-neutral-300 hover:bg-foreground/5 dark:hover:bg-white/5 focus:ring-primary/50',
              `plausible-event-name=Pricing+${tier.name}`,
            ]}
          >
            {tier.cta}
          </button>
        )}
      </Card>
    ))}
  </div>

  <div class="mt-12 text-center reveal">
    <a
      href="/pricing/"
      class="inline-flex items-center gap-2 font-heading font-semibold text-sm text-primary hover:text-primary-hover transition-colors group plausible-event-name=Pricing+See+Full"
    >
      See full feature comparison
      <svg class="w-4 h-4 transition-transform group-hover:translate-x-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M17 8l4 4m0 0l-4 4m4-4H3" />
      </svg>
    </a>
  </div>
</Section>
